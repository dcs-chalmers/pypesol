# README #

Pre-release readme file (v.0.1, April 2025).

Here a small guide to start experimenting with the Python Peer-to-Peer Energy Sharing Optimization Library (PyPESOL).

The software is shared under MIT license.

> **Disclaimer** The code is highly experimental and has only been tested on Ubuntu and MacOS. *Use with care!*

## For a New Fresh Install ###

1. Clone the source code.

2. Packages to install before running the code: (required) pyomo, (optional for some sub-components) numpy, scipy, pandas, prophet (**as of prophet v1.1, requires Python3.7**), plotly eg using the current Python3.7 installation:


```
pip3 install numpy scipy pyomo pandas plotly prophet
```

or complete install via conda and a virtual environment for *Python 3.7*, including two optimization solvers:

```
conda update anaconda
conda create -n py37 python=3.7
conda activate py37
conda install numpy scipy pandas plotly prophet redis
conda install -c conda-forge pyomo
conda install -c conda-forge ipopt glpk
```


3. Install a LP solver program. The default one that is configured in the code is 'cbc' solver. 


### Ubuntu

```
sudo apt-get install coinor-cbc
```

### MacOS

```
brew install cbc
```

4. For redis, make following installation (if installed in step 2, simply skip): 

### MacOS

```
brew install redis
```

Python package to install before running the code: 

```
pip install redis
```


5. Test the install (1 single problem solving):

```
run_experiments.sh 1 1 1
```


## Input -- Datasets ###

Look at:

* cons.csv

Household consumptions, each line is 1 hour of consumption.
That is: h1, h2, ..., hn consumption for hour1, then a newline and
the same for hour3 and so on.

The size is then N*365*24 numbers, N values per line.
where N is number of households.
(default unit kWh)

* price.csv

Yearly hourly price, so 365*24 numbers, 1 value per line.
(default unit â‚¬/kWh)

Here we can also use Nordpool prices?

* sun.csv

Solar profile, so 365*24 numbers, 1 value per line.
(default unit kWh/kWp)

We can re-use it or change for a customer-based profile.

* pv.csv

This is if you want to set PV capacities (then not autogenerated based on average load)

* battery.csv

This is if you want to set battery capacities (then not autogenerated based on average load)

## Basic usage

Each household will have PV capacity of average load, and same for battery capacities
```
a = AlrBdrOptimizer(1, 1, 'sun.csv','price.csv','cons.csv')
```

This will return the optimal yearly bill for house 0 (working alone)
```
a.optimize(h)
```
